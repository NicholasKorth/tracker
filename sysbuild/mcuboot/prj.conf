# MCUboot configuration with USB DFU support

# MCUboot settings
CONFIG_BOOT_MAX_IMG_SECTORS=256

# Use overwrite mode (uploads to secondary slot, copies to primary on boot)
# Note: SINGLE_APPLICATION_SLOT is NOT compatible with USB DFU
CONFIG_BOOT_UPGRADE_ONLY=y

# Flash driver (required for MCUboot)
CONFIG_FLASH=y

# Disable logging to save flash space (USB stack is large)
CONFIG_LOG=n
CONFIG_CONSOLE=n
CONFIG_UART_CONSOLE=n
CONFIG_USE_SEGGER_RTT=n
CONFIG_BOOT_BANNER=n

# Size optimizations
CONFIG_SIZE_OPTIMIZATIONS=y

# USB DFU Support - hold button on P0.02 during reset to enter DFU mode
CONFIG_BOOT_USB_DFU_GPIO=y

# Allow deprecated USB stack (MCUboot USB DFU still uses old stack)
CONFIG_WARN_DEPRECATED=n

# Stack size for USB
CONFIG_MAIN_STACK_SIZE=4096
